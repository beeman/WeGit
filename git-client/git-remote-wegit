#!/usr/bin/env node

// Imports
// =============================================================================

const net = require('net');
const cp = require('child_process');
const uuid = require('uuid/v4');

// Main
// =============================================================================

const main = async () => {
  const connection = net.connect({ port: 9001 }, () => {
    connection.on('data', message => {
      const parsedMessage = JSON.parse(message.toString());
      console.warn('IN', JSON.stringify(parsedMessage).slice(0, 200), '\n');
    });
    /*
    process.stdin.setEncoding('utf8');

    process.stdin.on('readable', async () => {

    });*/
    setTimeout(() => {
      connection.write(
        JSON.stringify({
          method: 'send',
          args: JSON.stringify({
            type: `app:ping`,
            payload: {},
          }),
        }),
      );
    }, 1000);
  });

  connection.on('end', () => {
    console.warn('disconnected from server');
  });
};

main();
